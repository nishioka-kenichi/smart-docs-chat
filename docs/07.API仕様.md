# APIä»•æ§˜æ›¸

## ğŸ“Œ æ¦‚è¦

Smart Docs Chat ã‚·ã‚¹ãƒ†ãƒ ã®å„ãƒ•ã‚§ãƒ¼ã‚ºã§æä¾›ã•ã‚Œã‚‹APIã®ä»•æ§˜ã‚’å®šç¾©ã—ã¾ã™ã€‚

---

## ğŸ”Œ å…±é€šä»•æ§˜

### ãƒ™ãƒ¼ã‚¹URL
```
http://localhost:8000/api/v1
```

### èªè¨¼
```http
Authorization: Bearer {API_KEY}
```

### ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
```json
{
  "status": "success|error",
  "data": {},
  "message": "string",
  "timestamp": "2025-01-21T10:00:00Z"
}
```

### ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
| ã‚³ãƒ¼ãƒ‰ | èª¬æ˜ |
|--------|------|
| 400 | Bad Request - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚¨ãƒ©ãƒ¼ |
| 401 | Unauthorized - èªè¨¼ã‚¨ãƒ©ãƒ¼ |
| 404 | Not Found - ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„ |
| 429 | Too Many Requests - ãƒ¬ãƒ¼ãƒˆåˆ¶é™ |
| 500 | Internal Server Error - ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ |

---

## ğŸ“‹ Phase 2: Advanced RAG API

### POST /search
é«˜åº¦ãªæ¤œç´¢ã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "query": "string",
  "options": {
    "use_hyde": true,
    "use_fusion": true,
    "use_rerank": true,
    "k": 10
  },
  "filters": {
    "source": ["notion", "google_drive"],
    "date_from": "2024-01-01",
    "date_to": "2025-01-21"
  }
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "query": "string",
    "answer": "string",
    "sources": [
      {
        "content": "string",
        "metadata": {
          "source": "notion",
          "page_id": "string",
          "score": 0.95
        }
      }
    ],
    "techniques_used": {
      "hyde": true,
      "fusion": true,
      "rerank": true
    },
    "processing_time": 3.2
  }
}
```

### POST /hyde
HyDEæ¤œç´¢ã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "query": "string",
  "k": 5
}
```

### POST /rag-fusion
RAG-Fusionæ¤œç´¢ã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "query": "string",
  "num_queries": 5,
  "k": 10
}
```

### POST /rerank
æ¤œç´¢çµæœã‚’å†é †ä½ä»˜ã‘

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "query": "string",
  "documents": [
    {
      "id": "string",
      "content": "string"
    }
  ],
  "top_k": 5,
  "method": "cohere|cross-encoder"
}
```

---

## ğŸ¤– Phase 3: LangGraph Agent API

### POST /agent/react
ReActã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "task": "string",
  "tools": ["search", "calculator", "web_search"],
  "max_iterations": 5,
  "thread_id": "string"
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "result": "string",
    "thoughts": [
      "Thought: æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹å¿…è¦ãŒã‚ã‚‹",
      "Action: search_knowledge_base",
      "Observation: æ¤œç´¢çµæœ..."
    ],
    "actions": [
      {
        "tool": "search_knowledge_base",
        "input": "string",
        "output": "string"
      }
    ],
    "iterations": 3
  }
}
```

### GET /agent/state/{thread_id}
ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®çŠ¶æ…‹ã‚’å–å¾—

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "thread_id": "string",
    "current_step": "thinking",
    "messages": [],
    "search_results": [],
    "reflection_count": 1,
    "metadata": {}
  }
}
```

### POST /agent/checkpoint
ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "thread_id": "string",
  "checkpoint_name": "string"
}
```

### POST /agent/restore
ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å¾©å…ƒ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "checkpoint_id": "string"
}
```

---

## ğŸ‘¥ Phase 4: Multi-Agent API

### POST /multi-agent/execute
ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "task": "string",
  "agents": ["researcher", "coder", "reviewer", "documenter"],
  "execution_mode": "parallel|sequential",
  "supervisor_config": {
    "max_iterations": 3,
    "timeout": 300
  }
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "task": "string",
    "agents_used": ["researcher", "coder", "reviewer"],
    "execution_time": 45.2,
    "individual_results": {
      "researcher": {
        "status": "completed",
        "result": "string",
        "time": 10.5
      },
      "coder": {
        "status": "completed",
        "result": "string",
        "time": 20.3
      }
    },
    "final_answer": "string",
    "shared_memory": {}
  }
}
```

### POST /reflection/execute
ã‚»ãƒ«ãƒ•ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "task": "string",
  "initial_response": "string",
  "max_iterations": 3,
  "criteria": {
    "completeness": true,
    "accuracy": true,
    "clarity": true
  }
}
```

### POST /requirements/generate
è¦ä»¶å®šç¾©ã‚’ç”Ÿæˆ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "project_description": "string",
  "num_personas": 3,
  "auto_interview": true
}
```

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "personas": [
      {
        "name": "string",
        "role": "string",
        "goals": [],
        "pain_points": [],
        "expectations": []
      }
    ],
    "interviews": [],
    "requirements": [
      {
        "category": "functional",
        "description": "string",
        "priority": "high",
        "acceptance_criteria": []
      }
    ]
  }
}
```

### POST /plan-execute/create
å®Ÿè¡Œè¨ˆç”»ã‚’ä½œæˆ

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "objective": "string",
  "context": "string",
  "auto_execute": false
}
```

---

## ğŸ“Š Monitoring API

### GET /metrics
ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "success",
  "data": {
    "total_requests": 1000,
    "average_response_time": 2.5,
    "success_rate": 0.98,
    "active_threads": 5,
    "cache_hit_rate": 0.75,
    "vector_db_size": 50000,
    "daily_usage": {
      "searches": 500,
      "agent_tasks": 100,
      "tokens_used": 1000000
    }
  }
}
```

### GET /health
ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯

#### ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```json
{
  "status": "healthy",
  "services": {
    "api": "healthy",
    "vectordb": "healthy",
    "llm": "healthy",
    "cache": "healthy"
  },
  "version": "1.0.0",
  "uptime": 86400
}
```

---

## ğŸ” Webhook API

### POST /webhooks/register
Webhookã‚’ç™»éŒ²

#### ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
```json
{
  "url": "https://example.com/webhook",
  "events": ["search.completed", "agent.finished"],
  "secret": "string"
}
```

### Webhookãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
```json
{
  "event": "search.completed",
  "timestamp": "2025-01-21T10:00:00Z",
  "data": {
    "query": "string",
    "result": "string",
    "processing_time": 3.2
  },
  "signature": "sha256=..."
}
```

---

## ğŸ“ SDKã‚µãƒ³ãƒ—ãƒ«

### Python SDK
```python
from smart_docs_chat import Client

# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
client = Client(
    api_key="your-api-key",
    base_url="http://localhost:8000/api/v1"
)

# Advanced RAGæ¤œç´¢
result = client.search(
    query="LangGraphã®ä½¿ã„æ–¹",
    use_hyde=True,
    use_fusion=True,
    use_rerank=True
)

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ
agent_result = client.agent.react(
    task="Pythonã§ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã‚’å®Ÿè£…ã—ã¦",
    tools=["coder", "reviewer"]
)

# ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
multi_result = client.multi_agent.execute(
    task="RAGã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆã¨å®Ÿè£…",
    agents=["researcher", "coder", "documenter"],
    execution_mode="parallel"
)
```

### JavaScript/TypeScript SDK
```typescript
import { SmartDocsChat } from 'smart-docs-chat-sdk';

// ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
const client = new SmartDocsChat({
  apiKey: 'your-api-key',
  baseUrl: 'http://localhost:8000/api/v1'
});

// Advanced RAGæ¤œç´¢
const result = await client.search({
  query: 'LangGraphã®ä½¿ã„æ–¹',
  options: {
    useHyde: true,
    useFusion: true,
    useRerank: true
  }
});

// ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ
const agentResult = await client.agent.react({
  task: 'Pythonã§ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã‚’å®Ÿè£…ã—ã¦',
  tools: ['coder', 'reviewer']
});
```

### cURLä¾‹
```bash
# Advanced RAGæ¤œç´¢
curl -X POST http://localhost:8000/api/v1/search \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{
    "query": "LangGraphã®ä½¿ã„æ–¹",
    "options": {
      "use_hyde": true,
      "use_fusion": true,
      "use_rerank": true
    }
  }'

# ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
curl http://localhost:8000/api/v1/health
```

---

## ğŸ”„ ãƒ¬ãƒ¼ãƒˆåˆ¶é™

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | åˆ¶é™ | å˜ä½ |
|---------------|------|------|
| /search | 100 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| /agent/* | 50 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| /multi-agent/* | 20 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |
| /metrics | 1000 | ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ† |

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [OpenAPIä»•æ§˜æ›¸](/docs/openapi.yaml)
- [Postmanã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³](/docs/postman_collection.json)
- [APIãƒ—ãƒ¬ã‚¤ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰](http://localhost:8000/docs)

---

*æœ€çµ‚æ›´æ–°: 2025å¹´1æœˆ21æ—¥*